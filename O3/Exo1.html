<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pluriel irrégulier (-eau, -au, -eu, -ou) + passé composé (être) — 6e</title>
<style>
  :root{
    --pastel: #e8f0fe;         /* bleu très clair */
    --pastel2:#ffe8cc;         /* orange très clair */
    --pastel3:#e6f4ea;         /* vert très clair */
    --text:#212529;
    --muted:#6c757d;
    --accent:#495057;
    --ok:#198754;
    --no:#d63384;
  }
  body{font:16px/1.5 system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);background:#fafafa;margin:0;padding:24px}
  h1{font-size:22px;margin:0 0 12px}
  .tips{color:var(--muted);margin-bottom:16px}
  .bar{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin:10px 0 18px}
  .btn{border:1px solid #dee2e6;border-radius:10px;background:#fff;padding:6px 10px;cursor:pointer}
  .btn.pastel{background:var(--pastel)}
  .btn.reset{background:var(--pastel3)}
  .score{margin-left:auto;font-weight:600}
  .card{border:1px solid #e9ecef;border-radius:14px;box-shadow:0 6px 16px rgba(0,0,0,.04);background-color:#fff;padding:14px 12px;margin:12px 0}
  .src{color:var(--muted);margin-bottom:8px}
  .row{display:flex;flex-wrap:wrap;gap:8px;align-items:baseline}
  .fixed{padding:0 6px}
  .in{
    font:inherit; line-height:1; padding:2px 6px; vertical-align:baseline;
    border:1px solid #ced4da; border-radius:8px; background:#fff;
    min-width:12ch;
  }
  .in.noun{min-width:16ch}
  .explain{font-size:13px;color:#9499a3;margin-top:6px}
  .feedback{margin-top:8px;font-size:14px}
  .ok{color:var(--ok)} .no{color:var(--no)}
  .muted{color:var(--muted)}
  .footer-note{font-size:13px;color:var(--muted);margin-top:16px}
  /* Menus/pastel / A+A- pastel */
  .btn.a{background:var(--pastel2)}
</style>
</head>
<body>
  <h1>Transformer au pluriel (irréguliers -eau, -au, -eu, -ou) • Passé composé avec <i>être</i></h1>
  <p class="tips">
    Règle rappel ⚡ : <b>-eau</b> → <b>-eaux</b>, <b>-au</b> → <b>-aux</b>, <b>-eu</b> → <b>-eux</b>, <b>-ou</b> → <b>-ous</b> 
    (exceptions en <b>-ou</b> → <b>-oux</b> : bijou, caillou, chou, genou, hibou, joujou, pou).
  </p>

  <div class="bar">
    <button class="btn pastel" id="verifier">Vérifier</button>
    <button class="btn reset" id="reset">Reset</button>
    <button class="btn a" id="aPlus">A+</button>
    <button class="btn a" id="aMoins">A-</button>
    <div class="score" id="scoreBox">Score : 0 / 10</div>
  </div>

  <div id="exo"></div>

  <p class="footer-note">
    Consigne : Transforme la phrase au <b>pluriel</b>. L’auxiliaire <code>sont</code> est déjà fourni. 
    Écris le <b>sujet au pluriel</b> et le <b>participe passé</b> (accordé).  
  </p>

<script>
/* =========================
   Données d'exercice (10)
   ========================= */
const items = [
  // -eau  → -eaux
  {id:1, singular:"Le bateau est arrivé.", subjSing:"Le bateau", subjPlur:"Les bateaux", pcp:"arrivés"},
  {id:2, singular:"Le niveau est monté.",  subjSing:"Le niveau", subjPlur:"Les niveaux", pcp:"montés"},
  // -au  → -aux
  {id:3, singular:"Le chameau est allé au point d’eau.", subjSing:"Le chameau", subjPlur:"Les chameaux", pcp:"allés"},
  // -eu  → -eux
  {id:4, singular:"Le feu est apparu soudainement.",  subjSing:"Le feu", subjPlur:"Les feux", pcp:"apparus"},
  {id:5, singular:"Le jeu est devenu populaire.",     subjSing:"Le jeu", subjPlur:"Les jeux", pcp:"devenus"},
  // -ou exception → -oux
  {id:6, singular:"Le bijou est tombé par terre.",    subjSing:"Le bijou", subjPlur:"Les bijoux", pcp:"tombés"},
  {id:7, singular:"Le chou est resté au potager.",    subjSing:"Le chou",  subjPlur:"Les choux",  pcp:"restés"},
  {id:8, singular:"Le genou est devenu douloureux.",  subjSing:"Le genou", subjPlur:"Les genoux", pcp:"devenus"},
  {id:9, singular:"Le hibou est revenu au nid.",      subjSing:"Le hibou", subjPlur:"Les hiboux", pcp:"revenus"},
  {id:10,singular:"Le pou est apparu dans les cheveux.",subjSing:"Le pou",subjPlur:"Les poux",   pcp:"apparus"},
];

const exo = document.getElementById('exo');

function makeRow(it){
  const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = `
    <div class="src"><b>Phrase de départ :</b> ${it.singular}</div>
    <div class="row">
      <input class="in noun" data-role="subj" placeholder="Sujet au pluriel (ex. ${it.subjPlur})" aria-label="Sujet au pluriel">
      <span class="fixed">sont</span>
      <input class="in" data-role="pcp" placeholder="participe passé (ex. ${it.pcp})" aria-label="Participe passé">
    </div>
    <div class="explain muted">Astuce : vérifie la terminaison du nom (eaux/aux/eux/ous-oux) et ajoute <b>-s</b> au participe passé (masc. plur.).</div>
    <div class="feedback" id="fb-${it.id}"></div>
  `;
  card.dataset.id = it.id;
  return card;
}

items.forEach(it=>exo.appendChild(makeRow(it)));

const $ = (s,ctx=document)=>ctx.querySelector(s);
const $$= (s,ctx=document)=>Array.from(ctx.querySelectorAll(s));

function norm(s){return s.normalize("NFC").replace(/\s+/g,' ').trim().toLowerCase();}

function checkAll(downloadReport=true){
  let good = 0;
  const lines = [];

  $$('.card', exo).forEach(card=>{
    const id = Number(card.dataset.id);
    const it = items.find(x=>x.id===id);
    const subj = $('[data-role="subj"]', card).value;
    const pcp  = $('[data-role="pcp"]',  card).value;
    const fb = $(`#fb-${id}`);

    const okSubj = norm(subj) === norm(it.subjPlur);
    const okPcp  = norm(pcp)  === norm(it.pcp);

    let msg = '';
    if (okSubj && okPcp){
      msg = `<span class="ok">✔ Parfait : ${it.subjPlur} sont ${it.pcp}.</span>`;
      good++;
    }else{
      const hints = [];
      if(!okSubj) hints.push(`Sujet attendu : <code>${it.subjPlur}</code>`);
      if(!okPcp)  hints.push(`Participe attendu : <code>${it.pcp}</code>`);
      msg = `<span class="no">✘ À corriger.</span> <span class="muted">${hints.join(' — ')}</span>`;
    }
    fb.innerHTML = msg;

    // Ligne de rapport
    lines.push([
      id,
      it.singular,
      subj, okSubj? "OK":"NOK", it.subjPlur,
      pcp,  okPcp ? "OK":"NOK", it.pcp
    ]);
  });

  $('#scoreBox').textContent = `Score : ${good} / ${items.length}`;

  if (downloadReport){
    // TéléRap automatique
    const header = ["#","Départ (sing.)","Réponse sujet","Sujet OK?","Sujet attendu","Réponse pcp","PCP OK?","PCP attendu"];
    const csv = [header].concat(lines).map(r=>r.map(cell=>{
      const s = String(cell).replaceAll('"','""');
      return `"${s}"`;
    }).join(',')).join('\r\n');

    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'TeleRap_pluriels_eaux_aux_eux_ous.csv';
    document.body.appendChild(a);
    a.click();
    a.remove();
  }
}

$('#verifier').addEventListener('click', ()=>checkAll(true));

$('#reset').addEventListener('click', ()=>{
  $$('.card', exo).forEach(card=>{
    $('[data-role="subj"]', card).value='';
    $('[data-role="pcp"]',  card).value='';
    $(`#fb-${card.dataset.id}`).textContent='';
  });
  $('#scoreBox').textContent = 'Score : 0 / 10';
});

// A+ / A-
$('#aPlus').addEventListener('click', ()=>{
  document.documentElement.style.fontSize = '18px';
});
$('#aMoins').addEventListener('click', ()=>{
  document.documentElement.style.fontSize = '16px';
});
</script>
</body>
</html>
